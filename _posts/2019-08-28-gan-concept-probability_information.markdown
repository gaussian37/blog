---
layout: post
title: Basic Probability and Information Theory
date: 2019-08-21 00:00:00
img: gan/gan.png
categories: [gan-concept] 
tags: [probability, information theory, 정보이론, kl divergence] # add tag
---

- 이번 글에서는 `GAN`을 다루기 전에 필요한 기본적인 **확률과 정보이론**을 다루어 보려고 합니다.

<br>

- **1) Probability Model**
- **2) Discriminative Model**
- **3) Bayesian Theory**
- **4) Basic Information Theory**

<br>

<br>

### **4) Basic Information Theory**

<br>

- 이번에 다루어 볼 주제는 `Entropy`, `KL divergence`, `Mutual Information`입니다.
- 먼저 정보이론을 확률이론 및 결정이론과 비교하여 간단하게 식으로 알아보겠습니다.
- **Probability Theory**
    - 불확실성(Event, 변수등)에 대한 일어날 **가능성을 모델링** 하는 것입니다.
    - 　$$ P(Y \vert X) = \frac{ P(X \vert Y)P(Y) }{ P(X) } $$
- **Decision Theory**
    - 불확실한 상황에서 **추론에 근거해 결정**을 내리는 것입니다.
    - 　$$ Y = 1 $$, if $$ \frac{ P(x \vert y = 1)P(y=1) }{ P(x \vert y = 0)P(y=0) } > 1 $$ 
- **Information Theory**
    - 확률 분포 $$ P(x) $$의 불확실성 정도를 평가하는 방법
    - 　$$ H(X) = -\sum_{x}P(x)log_{2}P(x) $$
    
<br>

- 그러면 먼저 간단하게 `정보량(Information)`이 무엇인지 알아보도록 하겠습니다.
- 예를 들어 1 ~ 16까지 16개 숫자 중에서 1개의 숫자를 하나 생각한 다음 다른 사람이 내가 생각한 숫자를 맞추도록 하려고 합니다. 이 때 최소 몇 번 물어야 할까요?
    - 질문을 들으면 아시겠지만 이진 탐색으로 풀 수 있는 쉬운 문제입니다.
- 이 문제의 정답은 4번 입니다. 이진탐색으로 정답을 찾게 되면 $$ n = log_{2}16 = 4 $$(단위: bit)가 됩니다.
- 여기서 `정보량`을 정의할 수 있는데, **불확실함을 해소하기 위해 필요한 질문(정보)의 수(불확실한 정도)라고** 할 수 있습니다.
- 특히, 정보량의 단위는 `bit`로 표현하게 됩니다. (Yes / No 대답에 해당합니다.)

<br>

- 여기서 **정보량과 확률의 관계**를 살펴보겠습니다.
- 카드 한장을 선택할 확률 $$ p = 1/16 $$으로 모두 동일합니다.
- 선택한 카드를 맞추기 위한 정보량을 확률 $$ p $$를 이용해 표현해 보면
    - 　$$ n = -log_{2}(p) = log_{2}(1/p) = log_{2}(16) = 4 $$ 가 됩니다.
- 일반적으로 어떤 사상의 확률이 $$ p $$라고 하였을 때, 그 사상에 대한 정보량 $$ I $$는 다음과 같습니다.
    - 　$$ I = log_{2}(\frac{1}{p}) = -log_{2}(p) $$
- 정보량을 계산하는 방법을 다음 예로 살펴보겠습니다.
    - 주사위를 던져서 짝수의 눈이 나타날 사상 $$ E_{1} $$의 정보량
        - 　$$ P(E_{1}) = \frac{1}{2} \to I = -log_{2}\frac{1}{2} = 1 (bit) $$
    - 주사위를 던져서 2의 눈이 나타날 사상 $$ E_{2} $$의 정보량
        - 　$$ P(E_{2}) = \frac{1}{6} \to I = -log_{2}\frac{1}{6} = 2.584962...(bit) $$
    - 주사위를 던져서 1 ~ 6이 나타날 사상 $$ E_{3} $$의 정보량
        - 　$$ P(E_{3}) = \frac{6}{6} = 1 \to I = -log_{2}1 = 0 (bit) $$

<br>

- 이번에는 정보이론에서 중요한 개념인 `Entropy`에 대하여 알아보도록 하겠습니다.
- 카드 16장 중 임의의 카드 선택에 대한 **평균적 정보량**은 다음과 같이 계산할 수 있습니다.
- 　$$ H(X) = -\sum_{i=1}^{16} P(X=i)log_{2}P(X=i) \to \sum_{i=1}^{16}\frac{1}{16} * log_{2}(\frac{1}{16}) = 4(bit) $$
- 이는 불확실성을 해소하기 위해서 **평균적으로 4번의 질문이 필요**하다는 의미입니다.
- `Entropy`란 확률분포 $$ P(X) $$에 대한 **정보량의 기댓값**입니다.
- 예를 들어 동전던지기를 하여 앞면, 뒷면의 발생 확률이 각각 1/2 일 때, 앞몇 뒷면을 맞추기 위해 필요한 평균적 정보량은 얼마일까요?
    - 　$$ H(X) = -\sum_{X}P(X)log_{2}P(X) = H(P) = ( P(X=H) * (-logP(X=H)) ) \ + \ ( P(X=T) * (-logP(X=T))) $$
    - 　$$ = \frac{1}{2} * ( -log_{2}(\frac{1}{2})) + \frac{1}{2} * (-log_{2}(\frac{1}{2})) = 1(bit) $$
    - 따라서 동전을 던졌을 때, 앞면 또는 뒷면을 맞추기 위해 필요한 질문의 횟수(정보량)은 1번입니다.
- 또다른 예로 초록공과 붉은공을 선택할 확률이 각각 2/8, 6/8이라고 할 때, 초록공과 붉은공을 맞추기 위한 평균적 정보량은 얼마일까요?
    - 　$$ H(X) = -\sum_{X}P(X)log_{2}P(X) = \frac{2}{8} * (-log_{2}(\frac{2}{8})) + \frac{6}{8} * (-log_{2}(\frac{6}{8})) = 0.812277...(bit) $$         

<br>

- 위에서 다룬 동전 던지기의 예를 통해 **엔트로피의 크기 변화**에 대하여 알아보도록 하겠습니다.
- 동전의 앞면이 나올 확률 $$ P(X=Head) = p $$라고 하고 뒷면이 나올 확률은 $$ P(X=Tail) = 1-p $$라고 하겠습니다.
- 그러면 동전 던지기의 `Entropy`는 $$ H_{P} = -plog_{2}p - (1-p)log_{2}(1-p) $$가 됩니다.
    - 여기서 P는 동전의 앞면이 나올 확률이라고 가정하겠습니다.
- 가로축을 $$ P $$, 세로축을 $$ H(P) $$ 라고 하면 다음과 같은 `Entropy` 크기 변화 분포를 가지게 됩니다.  

<br>
<center><img src="../assets/img/gan/concept/prob_info/1.png" alt="Drawing" style="width: 800px;"/></center>
<br>

- 만약 동전의 앞면이 나올 확률이 0.5라면 $$ H(x) = -\sum_{x}P(x)logP(x) = -(0.5 * log_{2}0.5 + 0.5*log_{2}0.5) = 1
- 확률분포 $$ p(x) $$에 따른 `Entropy` H(x)에 대한 성질을 보면 다음과 같습니다.

<br>
<center><img src="../assets/img/gan/concept/prob_info/2.png" alt="Drawing" style="width: 800px;"/></center>
<br>

- 왼쪽 그림과 같이 **불균형한 분포**에서는 **불확실성이 낮습니다.** 특정 사건이 발생할 확률이 높기 때문에 예측이 가능하지요.
    - 이런 경우 불확실성이 적으므로 **Entropy 가 낮습니다.**
- 오른쪽 그림과 같이 **균등한 분포**에서는 **불확실성이 높습니다.** 마치 주사위를 던졌을 때, 어느 눈이 나오기 예측하기 어려운것 처럼 예측하기가 어렵습니다.
    - 이런 경우 불확실성이 크므로 **Entropy가 높습니다.**

<br>

- 마지막으로 정보 이론에 대하여 정리해 보도록 하겠습니다.
- `Entropy`는 확률 분포 $$ p(x) $$에서 일어날 수 있는 모든 사건들의 **정보량의 기댓값**으로 $$ p(x) $$의 불확실성 정도를 나타냅니다.
- `Cross Entropy`는 실제 데이터 $$ P $$의 분포로부터 생성되지만, **분포 Q를 사용하여 정보량을 측정**해서 나타낸 평균적 bit수를 의미합니다.
- `KL divergence`는 두 확률 분포 $$ P $$와 $$ Q $$의 차이를 측정합니다.
- `Mutual Information`은 두 확률 변수들이 **얼마나 서로 dependent한 지 측정**합니다.