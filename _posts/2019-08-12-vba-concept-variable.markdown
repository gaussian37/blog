---
layout: post
title: 변수의 선언, 형식, 범위
date: 2019-08-09 00:00:00
img: vba/vba.png
categories: [vba-concept] 
tags: [vba, 개체, 개체 속성] # add tag
---

- 이번 글에서는 변수 선언, 형식 그리고 변수의 사용 범위에 대하여 다루어 보겠습니다.

<br>

## 변수 선언

<br>

- 변수는 `Dim, Static, Private, Public`문 등을 사용하여 변수를 선언합니다.
- 가장 일반적으로 사용하려는 프로시저에서 Dim문으로 다음과 같이 변수를 선언합니다.
    - `Dim 변수이름 As 데이터 형식`
- 변수를 여러개 같이 선언할 수도 있습니다.
    - `Dim name as String, age as Integer` 
- 변수 선언 시 버그가 나지 않게 하기 위하여 `Option Explicit`을 선언하는 것을 강력히 추천드립니다.
    - 예상치 못한 오타로 인하여 변수가 자동 생성 되면 버그 잡기가 너무 어렵기 때문입니다.

<br>

## 변수의 데이터 형식

<br>

- 변수를 선언할 때 적절한 데이터 형식을 사용하는 것은 매우 중요합니다. 
- 데이터 형식을 지정하지 않고 `Dim number`과 같이 지정할 수도 있지만 이렇게 되면 `Variant` 데이터 형식이 자동으로 입력되어지게 됩니다.
    - 이러한 경우 16Byte 메모리 공간이 차지하게 되므로 비효율적입니다.
- 따라서 데이터 형식을 지정하지 않으면 **Variant**타입이 지정되어 메모리 공간의 효율성과 처리 속도 모두 악영향을 미치므로 특별한 경우를 빼고는 다음 중 하나의 형식을 지정해 줍니다.

<br>
<center><img src="../assets/img/vba/concept/varialbe/1.PNG" alt="Drawing" style="width: 600px;"/></center>
<br>

## 변수의 사용 범위

<br>

- 변수를 선언할 때, 사용한 명령문과 선언 위치에 따라 변수의 사용 범위가 달라집니다.
- 어떤 변수는 해당 변수를 선언한 프로시저 내에서만 사용할 수 있지만, 어떤 변수는 해당 모듈의 모든 프로시저에서 공통으로 사용할 수도 있습니다.
- 프로시저 내에서 `Dim`으로 선언한 변수는 해당 프로시저 내에서만 사용할 수 있지만, 모듈의 시작 부분에서 `Dim`문으로 선언한 변수는 해당 모듈의 모든 프로시저에서 사용할 수 있습니다.
- 모듈의 시작 부분에서 `Public`으로 선언한 변수는 모든 모듈의 모든 프로시저에서 공통으로 사용할 수 있습니다.

<br>
<center><img src="../assets/img/vba/concept/varialbe/2.PNG" alt="Drawing" style="width: 600px;"/></center>
<br>